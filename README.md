# Delay-Shutter-Sync

<a href="https://mermaid-js.github.io/mermaid-live-editor/#/view/eyJjb2RlIjoiZ3JhcGhcblNbU3RhcnRdIFxuLS0-IHxSdW58RDpHUChEYXRhOiBHZW5lcmF0ZSBQb3NpdGlvbnMpXG4tLT4gRFM6SVAoRGVsYXkgU3RhZ2U6IEluaXRpYWwgUG9zaXRpb24pXG4tLT4gRDpTVChEYXRhOiBTZXQgU2h1dHRlciBUaW1lKVxuLS0-IFM6QyhTaHV0dGVyOiBDbG9zZSlcbi0tPiBTOkdTVChTaHV0dGVyOiBHZXQgU2h1dHRlciBTdGF0ZSlcbi0tPiBEUzpNTihEZWxheSBTdGFnZTogTW92ZSBOZXh0KVxuLS0-IERTOkdQKERlbGF5IFN0YWdlOiBHZXQgUG9zaXRpb24pXG4tLT4gSDpXKEhlbHBlcnM6IFdhaXQgQ2xvc2VkKVxuLS0-IFM6TyhTaHV0dGVyOiBPcGVuKVxuLS0-IFM6R1NUMihTaHV0dGVyOiBHZXQgU2h1dHRlciBTdGF0ZSkgXG4tLT4gSDpXMihIZWxwZXJzOiBXYWl0KVxuLS0-IEg6RT97SGVscGVyczogQXQgRW5kP31cbkg6RT8gLS0-IHxZZXN8IFM6QzIoU2h1dHRlcjogQ2xvc2UpXG5IOkU_IC0tPiB8Tm98IFM6Q1xuUzpDMiAtLT4gUzpHU1QzKFNodXR0ZXI6IEdldCBTaHV0dGVyIFN0YXRlKVxuLS0-IERTOklQMihEZWxheSBTdGFnZTogSW5pdGlhbCBQb3NpdGlvbilcbi0tPiBEUzpHUDIoRGVsYXkgU3RhZ2U6IEdldCBQb3NpdGlvbilcbi0tPiBFW0VuZF07XG5cbnN1YmdyYXBoIFJ1biBDeWNsZVxuICAgIFM6Q1xuICAgIFM6R1NUXG4gICAgRFM6TU5cbiAgICBEUzpHUFxuICAgIEg6V1xuICAgIFM6T1xuICAgIFM6R1NUMlxuICAgIEg6VzJcbiAgICBIOkU_XG5lbmRcblxuc3ViZ3JhcGggRGV2aWNlIENsZWFudXBcblM6QzJcblM6R1NUM1xuRFM6SVAyXG5EUzpHUDJcbmVuZFxuIiwibWVybWFpZCI6eyJ0aGVtZSI6ImRlZmF1bHQiLCJ0aGVtZVZhcmlhYmxlcyI6eyJiYWNrZ3JvdW5kIjoid2hpdGUiLCJwcmltYXJ5Q29sb3IiOiIjRUNFQ0ZGIiwic2Vjb25kYXJ5Q29sb3IiOiIjZmZmZmRlIiwidGVydGlhcnlDb2xvciI6ImhzbCg4MCwgMTAwJSwgOTYuMjc0NTA5ODAzOSUpIiwicHJpbWFyeUJvcmRlckNvbG9yIjoiaHNsKDI0MCwgNjAlLCA4Ni4yNzQ1MDk4MDM5JSkiLCJzZWNvbmRhcnlCb3JkZXJDb2xvciI6ImhzbCg2MCwgNjAlLCA4My41Mjk0MTE3NjQ3JSkiLCJ0ZXJ0aWFyeUJvcmRlckNvbG9yIjoiaHNsKDgwLCA2MCUsIDg2LjI3NDUwOTgwMzklKSIsInByaW1hcnlUZXh0Q29sb3IiOiIjMTMxMzAwIiwic2Vjb25kYXJ5VGV4dENvbG9yIjoiIzAwMDAyMSIsInRlcnRpYXJ5VGV4dENvbG9yIjoicmdiKDkuNTAwMDAwMDAwMSwgOS41MDAwMDAwMDAxLCA5LjUwMDAwMDAwMDEpIiwibGluZUNvbG9yIjoiIzMzMzMzMyIsInRleHRDb2xvciI6IiMzMzMiLCJtYWluQmtnIjoiI0VDRUNGRiIsInNlY29uZEJrZyI6IiNmZmZmZGUiLCJib3JkZXIxIjoiIzkzNzBEQiIsImJvcmRlcjIiOiIjYWFhYTMzIiwiYXJyb3doZWFkQ29sb3IiOiIjMzMzMzMzIiwiZm9udEZhbWlseSI6IlwidHJlYnVjaGV0IG1zXCIsIHZlcmRhbmEsIGFyaWFsIiwiZm9udFNpemUiOiIxNnB4IiwibGFiZWxCYWNrZ3JvdW5kIjoiI2U4ZThlOCIsIm5vZGVCa2ciOiIjRUNFQ0ZGIiwibm9kZUJvcmRlciI6IiM5MzcwREIiLCJjbHVzdGVyQmtnIjoiI2ZmZmZkZSIsImNsdXN0ZXJCb3JkZXIiOiIjYWFhYTMzIiwiZGVmYXVsdExpbmtDb2xvciI6IiMzMzMzMzMiLCJ0aXRsZUNvbG9yIjoiIzMzMyIsImVkZ2VMYWJlbEJhY2tncm91bmQiOiIjZThlOGU4IiwiYWN0b3JCb3JkZXIiOiJoc2woMjU5LjYyNjE2ODIyNDMsIDU5Ljc3NjUzNjMxMjglLCA4Ny45MDE5NjA3ODQzJSkiLCJhY3RvckJrZyI6IiNFQ0VDRkYiLCJhY3RvclRleHRDb2xvciI6ImJsYWNrIiwiYWN0b3JMaW5lQ29sb3IiOiJncmV5Iiwic2lnbmFsQ29sb3IiOiIjMzMzIiwic2lnbmFsVGV4dENvbG9yIjoiIzMzMyIsImxhYmVsQm94QmtnQ29sb3IiOiIjRUNFQ0ZGIiwibGFiZWxCb3hCb3JkZXJDb2xvciI6ImhzbCgyNTkuNjI2MTY4MjI0MywgNTkuNzc2NTM2MzEyOCUsIDg3LjkwMTk2MDc4NDMlKSIsImxhYmVsVGV4dENvbG9yIjoiYmxhY2siLCJsb29wVGV4dENvbG9yIjoiYmxhY2siLCJub3RlQm9yZGVyQ29sb3IiOiIjYWFhYTMzIiwibm90ZUJrZ0NvbG9yIjoiI2ZmZjVhZCIsIm5vdGVUZXh0Q29sb3IiOiJibGFjayIsImFjdGl2YXRpb25Cb3JkZXJDb2xvciI6IiM2NjYiLCJhY3RpdmF0aW9uQmtnQ29sb3IiOiIjZjRmNGY0Iiwic2VxdWVuY2VOdW1iZXJDb2xvciI6IndoaXRlIiwic2VjdGlvbkJrZ0NvbG9yIjoicmdiYSgxMDIsIDEwMiwgMjU1LCAwLjQ5KSIsImFsdFNlY3Rpb25Ca2dDb2xvciI6IndoaXRlIiwic2VjdGlvbkJrZ0NvbG9yMiI6IiNmZmY0MDAiLCJ0YXNrQm9yZGVyQ29sb3IiOiIjNTM0ZmJjIiwidGFza0JrZ0NvbG9yIjoiIzhhOTBkZCIsInRhc2tUZXh0TGlnaHRDb2xvciI6IndoaXRlIiwidGFza1RleHRDb2xvciI6IndoaXRlIiwidGFza1RleHREYXJrQ29sb3IiOiJibGFjayIsInRhc2tUZXh0T3V0c2lkZUNvbG9yIjoiYmxhY2siLCJ0YXNrVGV4dENsaWNrYWJsZUNvbG9yIjoiIzAwMzE2MyIsImFjdGl2ZVRhc2tCb3JkZXJDb2xvciI6IiM1MzRmYmMiLCJhY3RpdmVUYXNrQmtnQ29sb3IiOiIjYmZjN2ZmIiwiZ3JpZENvbG9yIjoibGlnaHRncmV5IiwiZG9uZVRhc2tCa2dDb2xvciI6ImxpZ2h0Z3JleSIsImRvbmVUYXNrQm9yZGVyQ29sb3IiOiJncmV5IiwiY3JpdEJvcmRlckNvbG9yIjoiI2ZmODg4OCIsImNyaXRCa2dDb2xvciI6InJlZCIsInRvZGF5TGluZUNvbG9yIjoicmVkIiwibGFiZWxDb2xvciI6ImJsYWNrIiwiZXJyb3JCa2dDb2xvciI6IiM1NTIyMjIiLCJlcnJvclRleHRDb2xvciI6IiM1NTIyMjIiLCJjbGFzc1RleHQiOiIjMTMxMzAwIiwiZmlsbFR5cGUwIjoiI0VDRUNGRiIsImZpbGxUeXBlMSI6IiNmZmZmZGUiLCJmaWxsVHlwZTIiOiJoc2woMzA0LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTMiOiJoc2woMTI0LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkiLCJmaWxsVHlwZTQiOiJoc2woMTc2LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTUiOiJoc2woLTQsIDEwMCUsIDkzLjUyOTQxMTc2NDclKSIsImZpbGxUeXBlNiI6ImhzbCg4LCAxMDAlLCA5Ni4yNzQ1MDk4MDM5JSkiLCJmaWxsVHlwZTciOiJoc2woMTg4LCAxMDAlLCA5My41Mjk0MTE3NjQ3JSkifX0sInVwZGF0ZUVkaXRvciI6ZmFsc2V9">Click here to view the state chart</a>

```mermaid

graph
S[Start] 
--> |Run|D:GP(Data: Generate Positions)
--> DS:IP(Delay Stage: Initial Position)
--> D:ST(Data: Set Shutter Time)
--> S:C(Shutter: Close)
--> S:GST(Shutter: Get Shutter State)
--> DS:MN(Delay Stage: Move Next)
--> DS:GP(Delay Stage: Get Position)
--> H:W(Helpers: Wait Closed)
--> S:O(Shutter: Open)
--> S:GST2(Shutter: Get Shutter State) 
--> H:W2(Helpers: Wait)
--> H:E?{Helpers: At End?}
H:E? --> |Yes| S:C2(Shutter: Close)
H:E? --> |No| S:C
S:C2 --> S:GST3(Shutter: Get Shutter State)
--> DS:IP2(Delay Stage: Initial Position)
--> DS:GP2(Delay Stage: Get Position)
--> E[End];

subgraph Run Cycle
    S:C
    S:GST
    DS:MN
    DS:GP
    H:W
    S:O
    S:GST2
    H:W2
    H:E?
end

subgraph Device Cleanup
S:C2
S:GST3
DS:IP2
DS:GP2
end



```
